# 타입스크립트의 타입 추론

## 타입스크립트와 점진적 타입 시스템

- 타입스크립트는 **점진적인 타입 시스템**(Gradual Type System)을 제공하는 언어입니다.
- 이는 개발자가 원하는 만큼 타입을 명시적으로 정의할 수도 있고, 타입스크립트가 자동으로 타입을 추론할 수도 있다는 뜻입니다.

  ```tsx
  let a: number = 10;
  ```
  ➡️ 위처럼 변수를 선언할 때 명시적으로 타입을 지정할 수 있습니다. 이렇게 하면 타입스크립트가 컴파일 타임(프로그램 실행 전)에 타입 검사를 수행할 수 있습니다.

<br />

- 하지만 타입을 명시하지 않더라도 초기값을 기준으로 타입스크립트가 타입을 자동으로 추론해 줍니다.

  ```tsx
  let a = 10;
  ```
  ➡️ 위 코드는 타입을 직접 명시하지 않았지만, 타입스크립트는 `a`의 초기값이 `10`이므로 `number` 타입으로 추론합니다. 이렇게 타입을 자동으로 추론하는 기능은 개발자가 불필요한 타입 주석을 생략할 수 있도록 도와줍니다.

<br />

### 타입 추론이 어려운 경우

- 모든 경우에 타입을 정확히 추론할 수 있는 것은 아닙니다.
- 예를 들어, 함수의 매개변수에는 기본적으로 타입을 지정해 주어야 합니다.

  ```tsx
  function func(param) {
    return param;
  }
  ```
  ➡️ 위 함수의 `param`은 타입을 명시하지 않았기 때문에, 기본적으로 `any` 타입이 됩니다. 따라서 타입 안정성을 보장하려면 매개변수 타입을 직접 지정하는 것이 좋습니다.

---

## 타입 추론이 가능한 상황

### 1. 변수 선언 시 초기값을 기준으로 타입 추론

- 타입스크립트는 **변수의 초기 값**을 기준으로 타입을 추론합니다.

  ```tsx
  let a = 10; // number
  let b = "hello"; // string
  let c = {
    id: 1,
    name: "이정환",
    profile: {
      nickname: "kwn",
    },
  };
  ```
  <img width="350" alt="초기값을 기준으로 타입 추론" src="https://github.com/user-attachments/assets/a4ef15d6-a5b2-41bb-ae8b-e7ad4ed857e0" />

  - 객체와 같이 구조가 복잡한 데이터도 타입스크립트는 정확하게 타입을 추론합니다.

<br />

### 2. 객체 구조분해 할당

- 객체를 구조분해 할당할 때에도 타입을 자동으로 추론합니다.

  ```tsx
  let { id, name, profile } = c;
  ```
  <img width="350" alt="객체 구조분해 할당" src="https://github.com/user-attachments/assets/3b29c6c3-38d3-41d4-ac6e-a3bc68a22d1f" />

  - 이 경우 `id`는 `number`, `name`은 `string`, `profile`은 `{ nickname: string }` 타입으로 추론됩니다.

<br />

### 3. 배열 구조분해 할당

- 배열 구조분해 할당을 할 때에도 각 요소의 타입을 자동으로 추론합니다.

  ```tsx
  let [one, two, three] = [1, "hello", true];
  ```
    - `one: number`
    - `two: string`
    - `three: boolean`

<br />

### 4. 함수의 반환값 타입 추론

- 함수의 반환값 타입도 타입스크립트가 자동으로 추론합니다.

  ```tsx
  function func() {
    return "hello";
  }
  ```
  - 이 경우 타입스크립트는 `return` 문을 보고 `func`의 반환 타입을 `string`으로 추론합니다.

<br />

### 5. 기본값이 설정된 매개변수

- 매개변수에 기본값이 설정된 경우, 기본값을 기준으로 타입을 추론합니다.

  ```tsx
  function func2(message = "hello") {
    return message;
  }
  ```
  <img width="350" alt="스크린샷 2025-03-02 15 05 08" src="https://github.com/user-attachments/assets/2226451e-508f-4584-a689-179a5a7e5552" />

  - 여기서 `message`는 `string` 타입으로 자동 추론됩니다.

---

## 특이한 타입 추론 상황

### 1. 초기값이 없는 변수 선언

- 초기값 없이 변수를 선언하면 타입스크립트는 `any` 타입으로 추론합니다.

  ```tsx
  let d; // d: any
  ```
- 하지만 값이 할당되면 해당 타입으로 진화하는 특성이 있습니다.

  ```tsx
  d = 10;
  d.toFixed(); // number 타입으로 진화
  
  d = "hello";
  d.toUpperCase(); // string 타입으로 진화
  ```
  - 이처럼 `any` 타입은 할당된 값에 따라 타입이 변하는 **암묵적 any 타입 진화(Implicit Any Evolution)** 특성을 가집니다.

**정리**
```tsx
let d; // 암묵적인 any 타입
d = 10; // 10이라는 number type의 값을 넣는 순간 number type으로 진화한다.
d.toFixed(); // 여기서부터 number type이 된다.

d = "hello"; // "hello"라느 string type의 값을 넣어주면
d.toUpperCase(); // 이 라인부터는 string type으로 진화한다.
```

<br />

### 2. `const` 키워드를 사용한 변수

- `const`로 선언된 변수는 **리터럴 타입(literal type)** 으로 추론됩니다.

  ```tsx
  const num = 10;
  ```
  - 이 경우 `num`의 타입은 단순한 `number`가 아니라 **값 자체(10)** 가 됩니다.
  - 즉, `num: 10`(`number literal 타입`)으로 추론되며, 다른 값을 할당할 수 없습니다.

<br />

### 3. 여러 타입의 요소를 포함한 배열

```tsx
let arr = [1, "string"];
```
- 이 경우 타입스크립트는 배열의 모든 요소 타입을 검사하여 **최소 공통 타입**을 찾습니다. 결과적으로 `arr`의 타입은 `(string | number)[]`로 추론됩니다.

---

## 타입 넓히기 (Type Widening)

- 타입스크립트는 변수를 보다 **범용적으로 사용할 수 있도록** 타입을 넓히는 과정을 거칩니다. 이를 **타입 넓히기**(Type Widening)라고 합니다.

- 예를 들어 다음과 같은 변수를 선언하면:

  ```tsx
  let message = "hello";
  ```

  - 타입스크립트는 `message`를 단순히 "hello"라는 값이 아닌, 보다 넓은 `string` 타입으로 추론합니다. 이는 변수를 더 다양한 값과 함께 사용할 수 있도록 하기 위함입니다.

- 하지만 `const`를 사용하면 타입이 넓어지지 않습니다.

  ```tsx
  const message = "hello";
  ```
  - 이 경우 `message`의 타입은 `string`이 아니라 **리터럴 타입**인 `"hello"`로 고정됩니다.

---

## 정리

- **타입스크립트는 대부분의 경우 타입을 자동으로 추론**하며, 타입을 직접 명시하지 않아도 초기값을 기반으로 적절한 타입을 지정합니다.
- **객체, 배열, 함수 반환값 등 다양한 상황에서 타입 추론이 가능**합니다.
- 초기값 없이 변수를 선언하면 기본적으로 `any` 타입이 되며, 할당되는 값에 따라 타입이 진화합니다.
- `const` 키워드로 선언된 변수는 **리터럴 타입**으로 추론됩니다.
- 여러 타입의 요소를 포함하는 배열은 **최소 공통 타입**을 찾아 추론합니다.
- 타입스크립트는 **타입 넓히기(Type Widening)** 를 통해 변수를 보다 유연하게 사용할 수 있도록 합니다.

💡 타입스크립트의 강력한 타입 추론 기능을 활용하면 불필요한 타입 명시를 줄이고, 더욱 간결하고 안전한 코드를 작성할 수 있습니다!

